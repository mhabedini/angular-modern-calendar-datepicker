<div
  [class.dark]="darkMode"
  [dir]="dateService.config.rtl ? 'rtl' : 'ltr'"
  [class.font-sans_en]="calendarType === 'gregorian'"
  class="flex flex-col w-[22.5rem] border rounded-xl py-4 bg-white dark:bg-gray-800">
  <div class="flex flex-row justify-between items-center px-4">
    <a
      (click)="onPreviousMonthClick()"
      class="cursor-pointer ps-0.5 py-2 leading-4 flex flex-row items-center text-xs text-gray-500 dark:text-gray-200 gap-1">
      <div class="border-s border-b border-primary w-2 h-2 rtl:-rotate-45 ltr:rotate-45"></div>
      {{dateService.options.translate.previousMonth}}
    </a>
    <div
      class="flex justify-center text-primary gap-2">
      <div
        (click)="onYearToggle()"
        class="rounded-full bg-primary bg-opacity-10 dark:bg-opacity-20 px-4 py-2 cursor-pointer font-bold text-sm">
        {{dateService.currentYear}}
      </div>

      <div
        (click)="onMonthToggle()"
        class="rounded-full bg-primary leading-4 bg-opacity-10 px-4 py-2 cursor-pointer font-bold text-sm">
        {{dateService.currentMonthName}}
      </div>
    </div>
    <div
      (click)="onNextMonthClick()"
      class="cursor-pointer pe-0.5 py-2 flex flex-row items-center text-xs text-gray-500 dark:text-gray-200 gap-1">
      {{dateService.options.translate.nextMonth}}
      <div class="border-e border-t border-primary w-2 h-2 rtl:-rotate-45 ltr:rotate-45"></div>
    </div>
  </div>

  <div
    *ngIf="calendarSelectorMode === 'date'"
    class="flex flex-col mt-4 px-4">
    <div class="flex flex-row gap-2 text-sm bg-primary text-white rounded-lg">
      <div
        [class.text-xs]="calendarType === 'hijri'"
        class="flex w-10 h-10 items-center justify-center"
        *ngFor="let day of dateService.weekdaysShort">{{day}}</div>
    </div>

    <div class="flex flex-col mt-4 gap-4">
      <div
        *ngFor="let week of dates"
        class="flex flex-row">
        <div
          class="flex w-10 ms-2 first:ms-0 cursor-pointer h-10 p-1 font-medium text-black dark:text-white justify-center rounded"
          [class.!text-red-500]="dateService.config.weekends?.includes(day.weekDay)"
          [class.dark:!text-red-400]="dateService.config.weekends?.includes(day.weekDay)"
          [class.hover:text-primary]="calendarMode !== 'normal' && day.isForCurrentMonth && !(selectedEndDate === undefined && selectedStartDate !== undefined && day.date.isBefore(selectedStartDate))"
          [class.hover:bg-primary]="calendarMode !== 'normal' && day.isForCurrentMonth && !(selectedEndDate === undefined && selectedStartDate !== undefined && day.date.isBefore(selectedStartDate))"
          [class.hover:bg-opacity-10]="calendarMode !== 'normal' && day.isForCurrentMonth"
          [class.!bg-opacity-10]="selectedEndDate !== undefined && day.date.isBetween(selectedStartDate, selectedEndDate)"
          [class.!ms-0]="(selectedEndDate !== undefined && day.date.isBetween(selectedStartDate, selectedEndDate) || selectedEndDate?.isSame(day.date))
          && !(day.date.diff(selectedEndDate, 'day') === 0 && day.date.diff(selectedStartDate, 'day') === 0)"
          [class.!w-12]="(selectedEndDate !== undefined && day.date.isBetween(selectedStartDate, selectedEndDate))"
          [class.!ps-2]="selectedEndDate !== undefined && day.date.isBetween(selectedStartDate, selectedEndDate)"
          [class.!rounded-none]="selectedEndDate !== undefined && day.date.isBetween(selectedStartDate, selectedEndDate)"
          [class.!border-none]="selectedEndDate !== undefined && day.date.isBetween(selectedStartDate, selectedEndDate)"
          [class.!w-16]="selectedEndDate?.diff(day.date, 'day') === 1 && day.date.isBetween(selectedStartDate, selectedEndDate)"
          [class.!w-11]="(day.date.isSame(selectedEndDate) && selectedEndDate?.diff(selectedStartDate, 'day') === 1)
          || (day.date.isSame(selectedStartDate) && selectedEndDate?.diff(selectedStartDate, 'day') === 1)"
          [class.dark:hover:bg-opacity-20]="day.isForCurrentMonth"
          [class.rounded-s-none]="day.date.isSame(selectedEndDate) && selectedEndDate?.diff(selectedStartDate, 'day') === 1"
          [class.rounded-e-none]="day.date.isSame(selectedStartDate) && selectedEndDate?.diff(selectedStartDate, 'day') === 1"
          [class.!text-opacity-30]="!day.isForCurrentMonth || (selectedEndDate === undefined && selectedStartDate !== undefined && day.date.isBefore(selectedStartDate))"
          [class.dark:!text-opacity-40]="!day.isForCurrentMonth || (selectedEndDate === undefined && selectedStartDate !== undefined && day.date.isBefore(selectedStartDate))"
          [class.!cursor-default]="calendarMode === 'normal' || !day.isForCurrentMonth || (selectedEndDate === undefined && selectedStartDate !== undefined && day.date.isBefore(selectedStartDate))"
          [class.!text-primary]="(day.isToday && day.isForCurrentMonth) || (selectedEndDate !== undefined && day.date.isBetween(selectedStartDate, selectedEndDate))"
          [class.!border]="day.isToday && day.isForCurrentMonth"
          [class.border-primary]="day.isToday && day.isForCurrentMonth"
          [class.!bg-primary]="(selectedDate?.isSame(day.date) && day.isForCurrentMonth)
          || selectedStartDate?.isSame(day.date) || selectedEndDate?.isSame(day.date)
          || (selectedEndDate !== undefined && day.date.isBetween(selectedStartDate, selectedEndDate))"
          [class.!text-white]="(selectedDate?.isSame(day.date) && day.isForCurrentMonth)
          || selectedStartDate?.isSame(day.date) || selectedEndDate?.isSame(day.date)"
          [class.dark:!text-white]="selectedDate?.isSame(day.date) && day.isForCurrentMonth"
          (click)="onNewDateSelect(day)"
          *ngFor="let day of week">
          <div
            [ngClass]="'items-center justify-center'"
            class="flex flex-col w-full">
            <div class="flex flex-row justify-center leading-4">{{day.day}}</div>
          </div>
        </div>
      </div>
    </div>
  </div>
  <div class=" px-4" *ngIf="calendarSelectorMode === 'month'">
    <div class="grid grid-cols-3 grid-rows-4 mt-4 gap-2">
      <div class="w-full flex items-center justify-center hover:font-bold
         h-16 border rounded-lg cursor-pointer text-sm hover:border-none
         hover:bg-opacity-10 hover:bg-primary hover:text-primary"
           [class.!border-primary]="month === dateService.currentMonthName"
           [class.!text-primary]="month === dateService.currentMonthName"
           (click)="changeCurrentMonth(i)"
           *ngFor="let month of dateService.months; let i = index;">
        {{month}}
      </div>
    </div>
  </div>

  <div class="ps-4 pe-2" *ngIf="calendarSelectorMode === 'year'">
    <div
      class="flex flex-col mt-4 gap-2 h-80 overflow-y-scroll">
      <div class="grid grid-cols-4 gap-2 mb-2" *uiScroll="let data of datasource">
        <div class="w-full flex items-center justify-center hover:font-bold
         h-10 border rounded-lg cursor-pointer text-sm hover:border-none gap-2
         hover:bg-opacity-10 hover:bg-primary hover:text-primary"
             *ngFor="let year of range(data * 4, data * 4 + 3, 1)"
             [class.!border-primary]="year == dateService.currentYear"
             [class.!text-primary]="year == dateService.currentYear"
             (click)="changeCurrentYear(year)">
          {{year}}
        </div>
      </div>
    </div>
  </div>

  <div class="mt-3 px-4">
    <a (click)="onGoToTodayClick()"
       class="h-10 bg-primary bg-opacity-10 font-bold dark:bg-opacity-20 rounded-lg text-primary text-sm flex items-center justify-center cursor-pointer">
      {{dateService.options.translate.goToToday}}
    </a>
  </div>
</div>
