import * as momentJalali from 'jalali-moment';
import * as moment from 'moment';
import { extendMoment } from 'moment-range';
import { getWeekFirstAndLastDays, processDateRange } from "../helper/date-helper";
export class JalaliDateService {
    constructor() {
        this.translate = {
            goToToday: 'برو به امروز',
            nextMonth: 'ماه بعد',
            previousMonth: 'ماه قبل',
        };
        this.config = {
            rtl: true,
            WeekendDays: [6]
        };
        momentJalali.locale('fa', { useGregorianParser: true });
    }
    months() {
        return [
            "فروردین",
            "اردیبهشت",
            "خرداد",
            "تیر",
            "مرداد",
            "شهریور",
            "مهر",
            "آبان",
            "آذر",
            "دی",
            "بهمن",
            "اسفند",
        ];
    }
    monthsShort() {
        return [
            "فروردین",
            "اردیبهشت",
            "خرداد",
            "تیر",
            "مرداد",
            "شهریور",
            "مهر",
            "آبان",
            "آذر",
            "دی",
            "بهمن",
            "اسفند",
        ];
    }
    weekdays() {
        return [
            "شنبه",
            "یکشنبه",
            "دوشنبه",
            "سه شنبه",
            "چهارشنبه",
            "پنجشنبه",
            "جمعه",
        ];
    }
    weekdaysShort() {
        return [
            "ش",
            "ی",
            "د",
            "س",
            "چ",
            "پ",
            "ج"
        ];
    }
    daysInMonth(date) {
        const jalaliDate = momentJalali(date);
        const jDaysInMonth = jalaliDate.jDaysInMonth();
        const jMonth = jalaliDate.jMonth();
        const jYear = jalaliDate.jYear();
        const startDate = moment(momentJalali(`${jYear}/${jMonth + 1}/01`, 'jYYYY/jMM/jDD').doAsGregorian().format('YYYY/MM/DD'));
        const endDate = moment(momentJalali(`${jYear}/${jMonth + 1}/${jDaysInMonth}`, 'jYYYY/jMM/jDD').doAsGregorian().format('YYYY/MM/DD'));
        const year = moment(startDate).year();
        const [weeks, startDateDayBefore, endDateDayAfter] = processDateRange(startDate, endDate);
        const momentRange = extendMoment(moment);
        const calendar = [];
        const now = moment();
        weeks.forEach((week) => {
            let [firstWeekDay, lastWeekDay] = getWeekFirstAndLastDays(weeks, week, year);
            const weekRange = momentRange.range(firstWeekDay, lastWeekDay);
            const finalWeeks = [];
            Array.from(weekRange.by('day')).forEach((day, index) => {
                const jDate = momentJalali(day);
                finalWeeks.push({
                    gDate: day,
                    date: jDate,
                    weekIndex: index,
                    day: jDate.date(),
                    isToday: day.isSame(now, "day"),
                    isForCurrentMonth: day.isBetween(startDateDayBefore, endDateDayAfter)
                });
            });
            calendar.push(finalWeeks);
        });
        return calendar;
    }
    loadDaysInMonthWithYearAndMonth(jYear, jMonth) {
        const date = moment(momentJalali(`${jYear}/${this.months().indexOf(jMonth) + 1}/01`, 'jYYYY/jMM/jDD').doAsGregorian().format('YYYY/MM/DD'));
        return this.daysInMonth(date.format('YYYY/MM/DD'));
    }
    getCurrentMonth(date) {
        return date.format('MMMM');
    }
    getCurrentYear(date) {
        return date.format('YYYY');
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiamFsYWxpLWRhdGUtc2VydmljZS5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uLy4uLy4uL3Byb2plY3RzL2FuZ3VsYXItcGVyc2lhbi1kYXRlcGlja2VyL3NyYy9saWIvc2VydmljZS9qYWxhbGktZGF0ZS1zZXJ2aWNlLnRzIl0sIm5hbWVzIjpbXSwibWFwcGluZ3MiOiJBQUFBLE9BQU8sS0FBSyxZQUFZLE1BQU0sZUFBZSxDQUFBO0FBQzdDLE9BQU8sS0FBSyxNQUFNLE1BQU0sUUFBUSxDQUFBO0FBQ2hDLE9BQU8sRUFBQyxZQUFZLEVBQUMsTUFBTSxjQUFjLENBQUM7QUFFMUMsT0FBTyxFQUFDLHVCQUF1QixFQUFFLGdCQUFnQixFQUFDLE1BQU0sdUJBQXVCLENBQUM7QUFFaEYsTUFBTSxPQUFPLGlCQUFpQjtJQWE1QjtRQVhBLGNBQVMsR0FBRztZQUNWLFNBQVMsRUFBRSxjQUFjO1lBQ3pCLFNBQVMsRUFBRSxTQUFTO1lBQ3BCLGFBQWEsRUFBRSxTQUFTO1NBQ3pCLENBQUM7UUFFRixXQUFNLEdBQUc7WUFDUCxHQUFHLEVBQUUsSUFBSTtZQUNULFdBQVcsRUFBRSxDQUFDLENBQUMsQ0FBQztTQUNqQixDQUFBO1FBR0MsWUFBWSxDQUFDLE1BQU0sQ0FBQyxJQUFJLEVBQUUsRUFBQyxrQkFBa0IsRUFBRSxJQUFJLEVBQUMsQ0FBQyxDQUFBO0lBQ3ZELENBQUM7SUFFRCxNQUFNO1FBQ0osT0FBTztZQUNMLFNBQVM7WUFDVCxVQUFVO1lBQ1YsT0FBTztZQUNQLEtBQUs7WUFDTCxPQUFPO1lBQ1AsUUFBUTtZQUNSLEtBQUs7WUFDTCxNQUFNO1lBQ04sS0FBSztZQUNMLElBQUk7WUFDSixNQUFNO1lBQ04sT0FBTztTQUNSLENBQUM7SUFDSixDQUFDO0lBRUQsV0FBVztRQUNULE9BQU87WUFDTCxTQUFTO1lBQ1QsVUFBVTtZQUNWLE9BQU87WUFDUCxLQUFLO1lBQ0wsT0FBTztZQUNQLFFBQVE7WUFDUixLQUFLO1lBQ0wsTUFBTTtZQUNOLEtB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K0IsQ0FBQyxLQUFhLEVBQUUsTUFBYztRQUMzRCxNQUFNLElBQUksR0FBRyxNQUFNLENBQUMsWUFBWSxDQUFDLEdBQUcsS0FBSyxJQUFJLElBQUksQ0FBQyxNQUFNLEVBQUUsQ0FBQyxPQUFPLENBQUMsTUFBTSxDQUFDLEdBQUcsQ0FBQyxLQUFLLEVBQUUsZUFBZSxDQUFDLENBQUMsYUFBYSxFQUFFLENBQUMsTUFBTSxDQUFDLFlBQVksQ0FBQyxDQUFDLENBQUE7UUFDM0ksT0FBTyxJQUFJLENBQUMsV0FBVyxDQUFDLElBQUksQ0FBQyxNQUFNLENBQUMsWUFBWSxDQUFDLENBQUMsQ0FBQTtJQUNwRCxDQUFDO0lBRUQsZUFBZSxDQUFDLElBQVM7UUFDdkIsT0FBTyxJQUFJLENBQUMsTUFBTSxDQUFDLE1BQU0sQ0FBQyxDQUFBO0lBQzVCLENBQUM7SUFFRCxjQUFjLENBQUMsSUFBUztRQUN0QixPQUFPLElBQUksQ0FBQyxNQUFNLENBQUMsTUFBTSxDQUFDLENBQUE7SUFDNUIsQ0FBQztDQUNGIiwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0ICogYXMgbW9tZW50SmFsYWxpIGZyb20gJ2phbGFsaS1tb21lbnQnXHJcbmltcG9ydCAqIGFzIG1vbWVudCBmcm9tICdtb21lbnQnXHJcbmltcG9ydCB7ZXh0ZW5kTW9tZW50fSBmcm9tICdtb21lbnQtcmFuZ2UnO1xyXG5pbXBvcnQge0RhdGVTZXJ2aWNlSW50ZXJmYWNlfSBmcm9tIFwiLi9kYXRlLXNlcnZpY2UtaW50ZXJmYWNlXCI7XHJcbmltcG9ydCB7Z2V0V2Vla0ZpcnN0QW5kTGFzdERheXMsIHByb2Nlc3NEYXRlUmFuZ2V9IGZyb20gXCIuLi9oZWxwZXIvZGF0ZS1oZWxwZXJcIjtcclxuXHJcbmV4cG9ydCBjbGFzcyBKYWxhbGlEYXRlU2VydmljZSBpbXBsZW1lbnRzIERhdGVTZXJ2aWNlSW50ZXJmYWNlIHtcclxuXHJcbiAgdHJhbnNsYXRlID0ge1xyXG4gICAgZ29Ub1RvZGF5OiAn2KjYsdmIINio2Ycg2KfZhdix2YjYsicsXHJcbiAgICBuZXh0TW9udGg6ICfZhdin2Ycg2KjYudivJyxcclxuICAgIHByZXZpb3VzTW9udGg6ICfZhdin2Ycg2YLYqNmEJyxcclxuICB9O1xyXG5cclxuICBjb25maWcgPSB7XHJcbiAgICBydGw6IHRydWUsXHJcbiAgICBXZWVrZW5kRGF5czogWzZdXHJcbiAgfVxyXG5cclxuICBjb25zdHJ1Y3RvcigpIHtcclxuICAgIG1vbWVudEphbGFsaS5sb2NhbGUoJ2ZhJywge3VzZUdyZWdvcmlhblBhcnNlcjogdHJ1ZX0pXHJcbiAgfVxyXG5cclxuICBtb250aHMoKTogc3RyaW5nW10ge1xyXG4gICAgcmV0dXJuIFtcclxuICAgICAgXCLZgdix2YjYsdiv24zZhlwiLFxyXG4gICAgICBcItin2LHYr9uM2KjZh9i02KpcIixcclxuICAgICAgXCLYrtix2K/Yp9ivXCIsXHJcbiAgICAgIFwi2KrbjNixXCIsXHJcbiAgICAgIFwi2YXYsdiv2KfYr1wiLFxyXG4gICAgICBcIti02YfYsduM2YjYsVwiLFxyXG4gICAgICBcItmF2YfYsVwiLFxyXG4gICAgICBcItii2KjYp9mGXCIsXHJcbiAgICAgIFwi2KLYsNixXCIsXHJcbiAgICAgIFwi2K/bjFwiLFxyXG4gICAgICBcItio2YfZhdmGXCIsXHJcbiAgICAgIFwi2KfYs9mB2YbYr1wiLFxyXG4gICAgXTtcclxuICB9XHJcblxyXG4gIG1vbnRoc1Nob3J0KCk6IHN0cmluZ1tdIHtcclxuICAgIHJldHVybiBbXHJcbiAgICAgIFwi2YHYsdmI2LHYr9uM2YZcIixcclxuICAgICAgXCLYp9ix2K/bjNio2YfYtNiqXCIsXHJcbiAgICAgIFwi2K7Ysdiv2KfYr1wiLFxyXG4gICAgICBcItiq24zYsVwiLFxyXG4gICAgICBcItmF2LHYr9in2K9cIixcclxuICAgICAgXCLYtNmH2LHbjNmI2LFcIixcclxuICAgICAgXCLZhdmH2LFcIixcclxuICAgICAgXCLYotio2KfZhlwiLFxyXG4gICAgICBcItii2LDYsVwiLFxyXG4gICAgICBcItiv24xcIixcclxuICAgICAgXCLYqNmH2YXZhlwiLFxyXG4gICAgICBcItin2LPZgdmG2K9cIixcclxuICAgIF07XHJcbiAgfVxyXG5cclxuICB3ZWVrZGF5cygpOiBzdHJpbmdbXSB7XHJcbiAgICByZXR1cm4gW1xyXG4gICAgICBcIti02YbYqNmHXCIsXHJcbiAgICAgIFwi24zaqdi02YbYqNmHXCIsXHJcbiAgICAgIFwi2K/ZiNi02YbYqNmHXCIsXHJcbiAgICAgIFwi2LPZhyDYtNmG2KjZh1wiLFxyXG4gICAgICBcItqG2YfYp9ix2LTZhtio2YdcIixcclxuICAgICAgXCLZvtmG2KzYtNmG2KjZh1wiLFxyXG4gICAgICBcItis2YXYudmHXCIsXHJcbiAgICBdO1xyXG4gIH1cclxuXHJcbiAgd2Vla2RheXNTaG9ydCgpOiBzdHJpbmdbXSB7XHJcbiAgICByZXR1cm4gW1xyXG4gICAgICBcIti0XCIsXHJcbiAgICAgIFwi24xcIixcclxuICAgICAgXCLYr1wiLFxyXG4gICAgICBcItizXCIsXHJcbiAgICAgIFwi2oZcIixcclxuICAgICAgXCLZvlwiLFxyXG4gICAgICBcItisXCJcclxuICAgIF07XHJcbiAgfVxyXG5cclxuICBkYXlzSW5Nb250aChkYXRlOiBzdHJpbmcpOiBhbnlbXSB7XHJcbiAgICBjb25zdCBqYWxhbGlEYXRlID0gbW9tZW50SmFsYWxpKGRhdGUpXHJcbiAgICBjb25zdCBqRGF5c0luTW9udGggPSBqYWxhbGlEYXRlLmpEYXlzSW5Nb250aCgpO1xyXG4gICAgY29uc3Qgak1vbnRoID0gamFsYWxpRGF0ZS5qTW9udGgoKVxyXG4gICAgY29uc3QgalllYXIgPSBqYWxhbGlEYXRlLmpZZWFyKClcclxuXHJcbiAgICBjb25zdCBzdGFydERhdGUgPSBtb21lbnQobW9tZW50SmFsYWxpKGAke2pZZWFyfS8ke2pNb250aCArIDF9LzAxYCwgJ2pZWVlZL2pNTS9qREQnKS5kb0FzR3JlZ29yaWFuKCkuZm9ybWF0KCdZWVlZL01NL0REJykpXHJcbiAgICBjb25zdCBlbmREYXRlID0gbW9tZW50KG1vbWVudEphbGFsaShgJHtqWWVhcn0vJHtqTW9udGggKyAxfS8ke2pEYXlzSW5Nb250aH1gLCAnallZWVkvak1NL2pERCcpLmRvQXNHcmVnb3JpYW4oKS5mb3JtYXQoJ1lZWVkvTU0vREQnKSlcclxuICAgIGNvbnN0IHllYXIgPSBtb21lbnQoc3RhcnREYXRlKS55ZWFyKClcclxuXHJcbiAgICBjb25zdCBbd2Vla3MsIHN0YXJ0RGF0ZURheUJlZm9yZSwgZW5kRGF0ZURheUFmdGVyXSA9IHByb2Nlc3NEYXRlUmFuZ2Uoc3RhcnREYXRlLCBlbmREYXRlKVxyXG5cclxuICAgIGNvbnN0IG1vbWVudFJhbmdlOiBhbnkgPSBleHRlbmRNb21lbnQobW9tZW50KVxyXG4gICAgY29uc3QgY2FsZW5kYXI6IGFueVtdID0gW11cclxuICAgIGNvbnN0IG5vdyA9IG1vbWVudCgpXHJcblxyXG4gICAgd2Vla3MuZm9yRWFjaCgod2VlazogYW55KSA9PiB7XHJcbiAgICAgIGxldCBbZmlyc3RXZWVrRGF5LCBsYXN0V2Vla0RheV0gPSBnZXRXZWVrRmlyc3RBbmRMYXN0RGF5cyh3ZWVrcywgd2VlaywgeWVhcilcclxuXHJcbiAgICAgIGNvbnN0IHdlZWtSYW5nZSA9IG1vbWVudFJhbmdlLnJhbmdlKGZpcnN0V2Vla0RheSwgbGFzdFdlZWtEYXkpXHJcbiAgICAgIGNvbnN0IGZpbmFsV2Vla3M6IGFueVtdID0gW11cclxuICAgICAgQXJyYXkuZnJvbSh3ZWVrUmFuZ2UuYnkoJ2RheScpKS5mb3JFYWNoKChkYXk6IGFueSwgaW5kZXgpID0+IHtcclxuICAgICAgICBjb25zdCBqRGF0ZSA9IG1vbWVudEphbGFsaShkYXkpXHJcbiAgICAgICAgZmluYWxXZWVrcy5wdXNoKHtcclxuICAgICAgICAgIGdEYXRlOiBkYXksXHJcbiAgICAgICAgICBkYXRlOiBqRGF0ZSxcclxuICAgICAgICAgIHdlZWtJbmRleDogaW5kZXgsXHJcbiAgICAgICAgICBkYXk6IGpEYXRlLmRhdGUoKSxcclxuICAgICAgICAgIGlzVG9kYXk6IGRheS5pc1NhbWUobm93LCBcImRheVwiKSxcclxuICAgICAgICAgIGlzRm9yQ3VycmVudE1vbnRoOiBkYXkuaXNCZXR3ZWVuKHN0YXJ0RGF0ZURheUJlZm9yZSwgZW5kRGF0ZURheUFmdGVyKVxyXG4gICAgICAgIH0pXHJcbiAgICAgIH0pXHJcbiAgICAgIGNhbGVuZGFyLnB1c2goZmluYWxXZWVrcyk7XHJcbiAgICB9KVxyXG5cclxuICAgIHJldHVybiBjYWxlbmRhclxyXG4gIH1cclxuXHJcbiAgbG9hZERheXNJbk1vbnRoV2l0aFllYXJBbmRNb250aChqWWVhcjogbnVtYmVyLCBqTW9udGg6IHN0cmluZyk6IGFueVtdIHtcclxuICAgIGNvbnN0IGRhdGUgPSBtb21lbnQobW9tZW50SmFsYWxpKGAke2pZZWFyfS8ke3RoaXMubW9udGhzKCkuaW5kZXhPZihqTW9udGgpICsgMX0vMDFgLCAnallZWVkvak1NL2pERCcpLmRvQXNHcmVnb3JpYW4oKS5mb3JtYXQoJ1lZWVkvTU0vREQnKSlcclxuICAgIHJldHVybiB0aGlzLmRheXNJbk1vbnRoKGRhdGUuZm9ybWF0KCdZWVlZL01NL0REJykpXHJcbiAgfVxyXG5cclxuICBnZXRDdXJyZW50TW9udGgoZGF0ZTogYW55KTogc3RyaW5nIHtcclxuICAgIHJldHVybiBkYXRlLmZvcm1hdCgnTU1NTScpXHJcbiAgfVxyXG5cclxuICBnZXRDdXJyZW50WWVhcihkYXRlOiBhbnkpOiBzdHJpbmcge1xyXG4gICAgcmV0dXJuIGRhdGUuZm9ybWF0KCdZWVlZJylcclxuICB9XHJcbn1cclxuIl19